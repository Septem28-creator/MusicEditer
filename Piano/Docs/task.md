### 一、核心目标
设计一套可解析的音乐符号抽象语言，并通过 C# 实现语法解析与多线程钢琴音播放功能，最终实现基于自定义脚本的自动化钢琴演奏。
### 二、具体任务优化
1. 音乐符号抽象语言（grammar）设计
* 需覆盖基础音乐元素：音名（C/D/E 等）、音高（八度划分，如 C4/C5）、时值（全音符、半音符、四分音符等，支持附点延长）、休止符、节拍速度（BPM）、调号（大调 / 小调）、连音线、强弱记号（p/f/mp 等）。
* 语法规则需简洁易懂，支持单行 / 多行注释（便于脚本可读性），支持段落划分（如重复段、前奏 / 间奏标记）。
* 示例语法片段：[BPM=120] C4(1/4) D4(1/4). E4(1/2) | R(1/4) // 四分音符附点延长半拍
2. C# 语法解析模块开发
* 实现词法分析（Tokenization）：识别音名、时值、符号等语法单元，过滤无效字符与注释。
* 实现语法分析（Parsing）：基于上下文无关文法构建抽象语法树（AST），校验语法合法性（如时值与节拍匹配、音高范围有效性）。 
* 输出结构化解析结果（如音符列表，包含音高、起始时间、持续时间、强弱参数）。
3. 多线程音频播放模块开发
* 基于解析结果，调用系统音频 API（如 Windows Multimedia API（winmm.dll）或 NAudio 库）生成对应频率的正弦波 / 钢琴采样音。
* 实现多线程调度：根据音符起始时间异步播放，支持同时播放和弦（多音符并行），避免线程阻塞导致的节奏偏移。
* 支持播放控制：暂停 / 继续、速度调节（基于 BPM 动态调整时值）、音量控制（映射强弱记号）。
### 三、补充约束与扩展
* 兼容性：支持 Windows 系统，若扩展需兼容跨平台（如 Linux/macOS），可选用跨平台音频库（如 CSCore）。
* 可扩展性：语法预留扩展接口（如未来支持滑音、颤音等装饰音），解析模块设计为插件式架构。
* 错误处理：解析阶段返回详细语法错误信息（位置 + 原因），播放阶段处理音频设备异常（如无输出设备时的提示）。
* 性能要求：解析与播放模块需高效，确保实时响应，避免明显延迟（目标延迟 < 50ms）。